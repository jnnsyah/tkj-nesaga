// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

// ============================================================================
// ENUMS
// ============================================================================

/// Level kesulitan learning path
enum LearningLevel {
  Foundation
  Beginner
  Intermediate
  Advanced
}

/// Status langkah dalam learning path
enum StepStatus {
  current
  available
  locked
}

/// Kategori mitra perusahaan
enum PartnerCategoryType {
  ISP
  Retail
  Service
  Instansi
}

/// Ukuran tampilan timeline
enum TimelineSize {
  normal
  large
}

/// Warna aksen untuk resource/recommendation
enum ResourceColor {
  red
  blue
  green
  orange
}

// ============================================================================
// LEARNING MODELS
// ============================================================================

/// Jalur pembelajaran terstruktur untuk kurikulum TKJ
model LearningPath {
  id            String    @id @default(uuid())
  slug          String    @unique /// identifier unik (e.g. "basic-networking")
  icon          String
  title         String
  level         LearningLevel
  levelVariant  String
  actionIcon    String?
  topics        String[]  /// topik-topik yang dicakup
  prerequisites String[]  /// prasyarat yang dibutuhkan

  steps           LearningStep[]
  recommendations LearningRecommendation[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("learning_paths")
}

/// Langkah-langkah dalam sebuah learning path
model LearningStep {
  id          Int        @id @default(autoincrement())
  title       String
  description String
  status      StepStatus
  mediaType   String?    /// Tipe media (e.g. "Video", "Video & Teks")
  order       Int        /// Urutan langkah dalam path

  learningPathId String
  learningPath   LearningPath @relation(fields: [learningPathId], references: [id], onDelete: Cascade)

  actions LearningStepAction[]

  @@map("learning_steps")
}

/// Aksi yang tersedia di setiap langkah learning (link video, teks, dsb)
model LearningStepAction {
  id    Int     @id @default(autoincrement())
  icon  String
  label String
  to    String? /// URL tujuan (opsional)

  learningStepId Int
  learningStep   LearningStep @relation(fields: [learningStepId], references: [id], onDelete: Cascade)

  @@map("learning_step_actions")
}

/// Rekomendasi resource untuk learning path
model LearningRecommendation {
  id          Int           @id @default(autoincrement())
  icon        String
  title       String
  description String
  href        String
  color       ResourceColor

  learningPathId String
  learningPath   LearningPath @relation(fields: [learningPathId], references: [id], onDelete: Cascade)

  @@map("learning_recommendations")
}

/// Sumber belajar eksternal (YouTube, sertifikasi, tutorial)
model ExternalResource {
  id          Int           @id @default(autoincrement())
  icon        String
  title       String
  description String
  href        String
  color       ResourceColor

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("external_resources")
}

// ============================================================================
// GUIDANCE MODELS
// ============================================================================

/// Dokumen template yang bisa diunduh untuk keperluan magang
model DownloadableDocument {
  id    Int    @id @default(autoincrement())
  title String
  ext   String /// Ekstensi file (e.g. ".DOCX")
  icon  String
  href  String

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("downloadable_documents")
}

/// Pertanyaan yang sering ditanyakan (FAQ) untuk bimbingan magang
model FrequentlyAskedQuestion {
  id          Int     @id @default(autoincrement())
  question    String
  answer      String  @db.Text
  defaultOpen Boolean @default(false)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("frequently_asked_questions")
}

/// Timeline fase magang (pra, pelaksanaan, pasca)
model InternshipTimeline {
  id          Int          @id @default(autoincrement())
  icon        String
  title       String
  description String       @db.Text
  size        TimelineSize @default(normal)
  highlight   Boolean      @default(false)
  order       Int          /// Urutan fase dalam timeline

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("internship_timelines")
}

// ============================================================================
// INTERNSHIP MODELS
// ============================================================================

/// Statistik program magang (jumlah mitra, persentase tersalurkan, durasi)
model InternshipStat {
  id    Int    @id @default(autoincrement())
  value String /// Nilai statistik (e.g. "50+", "100%")
  label String /// Label deskriptif

  @@map("internship_stats")
}

/// Definisi kategori mitra perusahaan dengan ikon dan deskripsi
model PartnerCategory {
  id       Int    @id @default(autoincrement())
  icon     String
  title    String @unique
  subtitle String

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("partner_categories")
}

/// Perusahaan mitra magang untuk siswa TKJ
model PartnerCompany {
  id          Int                 @id @default(autoincrement())
  name        String
  category    PartnerCategoryType
  verified    Boolean             @default(false)
  address     String
  phone       String?
  email       String?
  shortDesc   String?             @db.Text
  description String?             @db.Text

  reviews CompanyReview[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("partner_companies")
}

/// Review/testimoni dari siswa yang pernah magang di perusahaan mitra
model CompanyReview {
  id      Int    @id @default(autoincrement())
  name    String /// Nama reviewer
  role    String /// Peran/angkatan (e.g. "Angkatan 2022 â€¢ Jan - Jun 2023")
  initial String /// Inisial nama
  rating  Int    /// Rating 1-5
  text    String @db.Text

  partnerCompanyId Int
  partnerCompany   PartnerCompany @relation(fields: [partnerCompanyId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("company_reviews")
}

// ============================================================================
// PROGRAM MODELS
// ============================================================================

/// Fitur utama program TKJ (bidang keahlian yang diajarkan)
model ProgramFeature {
  id          Int    @id @default(autoincrement())
  icon        String
  title       String
  description String

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("program_features")
}

/// Highlight kurikulum TKJ
model CurriculumHighlight {
  id   Int    @id @default(autoincrement())
  text String

  @@map("curriculum_highlights")
}
